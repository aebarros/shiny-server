{
    "collab_server" : "",
    "contents" : "library(dplyr)\nlibrary(lubridate)\nlibrary(plyr)\nlibrary(reshape2)\nlibrary(purrr)\n\n#Import data\ndiscard<-c(\"Date\",\"Replicate\")\ndata.catch=read.table(\"data/tblFishCatchInfo.txt\", header= T, sep= \"\\t\")\ndata.tow=read.table(\"data/tblTowInfo.txt\", header= T, sep= \"\\t\")\ndata.tow<-data.tow[ , -which(names(data.tow) %in% discard)]\ndata.water=read.table(\"data/tblWaterInfo.txt\", header= T, sep= \"\\t\")\ndata.water<-data.water[ , -which(names(data.water) %in% discard)]\n\n#format TowDurations#\ndata.tow$TowDuration<-strptime(data.tow$TowDuration, \"%m/%d/%Y %H:%M:%S\")\n\n#convert TowDuration to just numbers#\ndata.tow$TowDuration <- strftime(data.tow$TowDuration, format=\"%H:%M:%S\")\ndata.tow$TowDuration <- gsub(\"00\", \"\", data.tow$TowDuration)\ndata.tow$TowDuration<-gsub(\":\",\"\",data.tow$TowDuration)\ndata.tow<-transform(data.tow, TowDuration = as.numeric(TowDuration))\n\n#reshape fish catch to wide format\ndata.catch.wide <- dcast(data.catch, RecordNumber + Date + Net ~ FishCode, value.var=\"AdjustedLabCount\",fun.aggregate=sum)\nhead(data.catch.wide)\n\n#join data\ndata=data.catch.wide%>%\n  inner_join(data.water)%>%\n  inner_join(data.tow)\nhead(data)\n\n\n#rename columns to match mapapp\ndata<-plyr::rename(data, c(\"RecordNumber\"=\"ID\",\"Net\"=\"Method\",\"Tide\"=\"TideText\", \"StationName\"=\"Polygon.Station\",\"AvgTrawlDepth\"=\"Depth\",\"Tide.Height\"=\"TideHeight\",\"Temp.C.StartTop\"=\"BegSurfTemp\",\n               \"Conductivity.uS.cm.StartTop\"=\"BegSurfCond\",\"Salinity.ppt.StartTop\"=\"BegSurfSalin\",\"DOSat.Percent.StartTop\"=\"BegSurfDO%\",\n               \"DOSat.mg.L.StartTop\"=\"BegSurfDO(mg/L)\",\"Temp.C.StartBottom\"=\"BegBotTemp\",\"Conductivity.uS.cm.StartBottom\"=\"BegBotCond\",\n               \"Salinity.ppt.StartBottom\"=\"BegBotSalin\",\"DOSat.Percent.StartBottom\"=\"BegBotDO%\",\"DOSat.mg.L.StartBottom\"=\"BegBotDO(mg/L)\",\n               \"Temp.C.EndTop\"=\"EndSurfTemp\",\"Conductivity.uS.cm.EndTop\"=\"EndSurfCond\",\"Salinity.ppt.EndTop\"=\"EndSurfSalin\",\n               \"DOSat.Percent.EndTop\"=\"EndSurfDO%\",\"DOSat.mg.L.EndTop\"=\"EndSurfDO(mg/L)\",\"Temp.C.EndBottom\"=\"EndBotTemp\",\n               \"Conductivity.uS.cm.EndBottom\"=\"EndBotCond\",\"Salinity.ppt.EndBottom\"=\"EndBotSalin\",\"DOSat.Percent.EndBottom\"=\"EndBotDO%\",\n               \"DOSat.mg.L.EndBottom\"=\"EndBotDO(mg/L)\",\"StartSecchi.cm.\"=\"BegSecchi\",\"EndSecchi.cm.\"=\"EndSecchi\",\"StartNTU\"=\"BegNTU\",\"StartpH\"=\"BegPH\",\"EndpH\"=\"EndPH\"))\n\n#remove unnecessary columns\nremovals<-c(\"StationNames\",\"CableAngle\",\"Latitude\",\"Longitude\",\"TrackNote\",\"SalinityZone\",\"WQStartFile\",\"WQEndFile\",\"SerialNumber\",\"DELSME\",\"LONSME/DELSME Hybrid\",\"UNID Centrarchidae\",\"UNID GOBY\",\"UNID Long Skinny\",\"UNID Non-Larval\",\"Chl.ug.L.StartBottom\",\"Chl.RFU.StartBottom\",\"Chl.ug.L.StartTop\",\"Chl.RFU.StartTop\",\"Chl.ug.L.EndTop\",\"Chl.RFU.EndTop\",\"Chl.ug.L.EndBottom\",\"Chl.RFU.EndBottom\")\ndata<-data[ , -which(names(data) %in% removals)]\nhead(data)\n\n#change date from type factor top type date\ndata$Date = as.Date(data$Date, format = \"%m/%d/%Y\")\n\n\nsaveRDS(data,file=\"C:\\\\Users\\\\Barros\\\\Desktop\\\\R\\\\shiny-server\\\\OtterTrawlMapApp\\\\data\\\\larvaldata.rds\")\n\n#debugging\ndebug=data%>%\n  filter(Method!=\"SLS\")%>%\n  filter(Method!=\"Mysid\")\n",
    "created" : 1488764155484.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "291066789",
    "id" : "4C5064AB",
    "lastKnownWriteTime" : 1488767159,
    "last_content_update" : 1488767159565,
    "path" : "C:/Users/Barros/Desktop/R/shiny-server/OtterTrawlMapApp/larvaldatacleaning.R",
    "project_path" : "larvaldatacleaning.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}